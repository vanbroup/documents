{% include 'includes/header.html' %}

<main class="container my-4">

<h1>Similarity between {{ document_type }} input and {{ document_type }} output ({{ diff_similarity | round(3) }}%)</h1>

<p>This diff shows the differences between the {{ document_type }} <strong>input file</strong> before it was parsed, processed and deduplicated to the structured layout, with the <strong>output file</strong> that is generated by combining the structured files.</p>

<p>Click the hamburger menu on the left top for a list with links to the <span id="nrChanges"></span> differences.</p>

<div class="diffContent">{{ diff_text }}</div>

</main>

<script>
    function toggleUnchangedVisibility(type) {
        const elements = document.querySelectorAll('main .diffContent .equal');
        elements.forEach(element => {
            element.classList.toggle('hidden');
        });
    }
    document.getElementById('toggleUnchanged').addEventListener('change', function () {
        toggleUnchangedVisibility();
    });

    // Add event listeners for toggle switches after the content is loaded
    document.addEventListener('DOMContentLoaded', function () {
        var changes = 0;
        var toc = ''

        document.querySelectorAll("main .diffContent .diff").forEach(function (change) {
            changes++;

            change.setAttribute("id", changes);        
            toc += "<li><a href=\"#" + changes + "\">" + changes + ": \"" + change.textContent.substring(0, 40).replaceAll('Â¶',' ') + "\"</a></li>";
        });

        document.getElementById("nrChanges").innerText = changes;
        document.getElementById("tocContent").innerHTML += toc;
    });
</script>
{% include 'includes/footer.html' %}